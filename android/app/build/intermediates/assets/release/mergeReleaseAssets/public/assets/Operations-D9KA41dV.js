import{j as e}from"./ui-4JzjGctU.js";import{r as i}from"./vendor-D63tyEUO.js";import{A as _}from"./AdminSubnav-DjjmxDuT.js";import{u as j,C as m,a as p,b as g,d as u,f,I as v,B as x,s as d,m as C,R as A,n as N}from"./index-D6Zlv4TB.js";import{SimpleAnalyticsWidget as k}from"./SimpleAnalyticsWidget-CjyADUOB.js";import{CancellationTracker as I}from"./CancellationTracker-f6hTi_xC.js";import{AdminTierStats as w}from"./AdminTierStats-C0LYPzUY.js";import{UserRequestLimits as E}from"./UserRequestLimits-DZWQRQMI.js";import{OpenAIApiStats as O}from"./OpenAIApiStats-BfydEHeY.js";import"./supabase-DmvLFwnu.js";const P=()=>{const[t,r]=i.useState(""),[o,l]=i.useState(!1),[n,c]=i.useState(!1),{toast:s}=j(),h=async()=>{l(!0);try{const{data:a,error:y}=await d.from("shared_settings").select("setting_key, setting_value").eq("setting_key","google_analytics_property_id");if(y)throw y;const b=a?.[0];r(b?.setting_value||"")}catch(a){console.error("Error loading Google Analytics settings:",a),s({title:"Error",description:"Failed to load settings",variant:"destructive"})}finally{l(!1)}},S=async()=>{c(!0);try{const{error:a}=await d.from("shared_settings").upsert({setting_key:"google_analytics_property_id",setting_value:t.trim()});if(a)throw a;s({title:"Saved",description:"Google Analytics property ID updated"})}catch(a){console.error("Error saving Google Analytics settings:",a),s({title:"Error",description:"Failed to save settings",variant:"destructive"})}finally{c(!1)}};return i.useEffect(()=>{h()},[]),e.jsxs(m,{children:[e.jsx(p,{children:e.jsx(g,{className:"text-base",children:"Google Analytics"})}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{htmlFor:"propertyId",className:"sr-only",children:"Property ID"}),e.jsx(v,{id:"propertyId",value:t,onChange:a=>r(a.target.value),placeholder:"GA4 Property ID",disabled:o,className:"h-9"}),e.jsx(x,{onClick:S,disabled:n||o||!t.trim(),className:"h-9 px-4",children:n?"Saving...":"Save"})]})})]})},G=()=>{const{clearSubscriptionCache:t}=C(),r=()=>{t({showToast:!0,delay:0})};return e.jsxs(x,{onClick:r,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"Clear Subscription Cache"]})};function K(){const[t,r]=i.useState(""),[o,l]=i.useState(!0),{toast:n}=j();i.useEffect(()=>{(async()=>{try{const{data:s,error:h}=await d.from("shared_settings").select("setting_value").eq("setting_key","shared_api_key").maybeSingle();!h&&s?.setting_value&&r(s.setting_value)}catch{console.warn("Failed to load shared key")}finally{l(!1)}})()},[]);const c=async()=>{try{const{error:s}=await d.from("shared_settings").upsert({setting_key:"shared_api_key",setting_value:t});if(s)throw s;n({title:"Saved",description:"Shared OpenAI API key updated."})}catch(s){n({title:"Error",description:s.message||"Failed to save key",variant:"destructive"})}};return e.jsxs(m,{children:[e.jsx(p,{children:e.jsx(g,{className:"text-base",children:"Shared OpenAI API Key"})}),e.jsxs(u,{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(f,{htmlFor:"sharedKey",className:"text-sm",children:"Shared Key (used for Paid users in trial or subscribed)"}),e.jsx(v,{id:"sharedKey",type:"password",value:t,onChange:s=>r(s.target.value),placeholder:"sk-...",disabled:o,className:"font-mono"})]}),e.jsx(x,{onClick:c,className:"w-full sm:w-auto",children:"Save"})]})]})}function H(){return N({title:"Admin Operations â€“ Engagement & Monitoring",description:"Monitor engagement, usage, and manage operational thresholds.",canonicalPath:"/admin/operations"}),e.jsxs("main",{className:"container mx-auto p-6 space-y-8 overflow-x-hidden bg-background min-h-[calc(100vh-80px)]",role:"main",children:[e.jsx("h1",{className:"sr-only",children:"Admin Operations"}),e.jsx(_,{}),e.jsx("section",{"aria-label":"Real-time analytics",children:e.jsx(k,{})}),e.jsx("section",{"aria-label":"Cancellation tracking",children:e.jsx(I,{})}),e.jsx("section",{"aria-label":"User request limits",children:e.jsx(E,{})}),e.jsx("section",{"aria-label":"User tiers overview",children:e.jsx(w,{})}),e.jsx("section",{"aria-label":"OpenAI API statistics",children:e.jsx(O,{})}),e.jsx("section",{"aria-label":"Google Analytics settings",children:e.jsx(P,{})}),e.jsx("section",{"aria-label":"Shared OpenAI key",children:e.jsx(K,{})}),e.jsxs("section",{"aria-label":"Cache management",className:"pb-24",children:[e.jsxs(m,{children:[e.jsx(p,{children:e.jsx(g,{className:"text-base",children:"Cache Management"})}),e.jsx(u,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Clear subscription cache if users are experiencing incorrect premium access on mobile devices."}),e.jsx(G,{})]})})]}),e.jsx("div",{className:"h-8"})]})]})}export{H as default};
//# sourceMappingURL=Operations-D9KA41dV.js.map
