import{j as e}from"./ui-4JzjGctU.js";import{A as R}from"./AdminSubnav-Bw1kytFe.js";import{o as E,u as S,s as b,C as w,a as y,b as k,i as I,d as C,r as U,t as L,v as j,w as V,x as _,f as m,I as u,T as D,B as v,c as O,R as N,y as W,z as $,n as q}from"./index-CNtalSg2.js";import G from"./BrandAssetsManager-Ci-19AlT.js";import{ColorManagement as H}from"./ColorManagement-CY4RVXOm.js";import{AdminSEOSettings as z}from"./AdminSEOSettings-DbtG9d52.js";import{_ as Y}from"./supabase-CG8ZnHQM.js";import{r as f}from"./vendor-D63tyEUO.js";import{S as P}from"./smartphone-C3ZD5vgF.js";import{G as K}from"./globe-BkLxb4-L.js";/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Q=E("circle-alert",J);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],Z=E("code",X),ee=()=>{const[a,i]=f.useState({appName:"",shortName:"",description:"",appId:"",internalName:"",appIcon:"",favicon:"",logo:"",themeColor:"",backgroundColor:"",webUrl:""}),[r,p]=f.useState(!0),[n,h]=f.useState(!1),{toast:t}=S();f.useEffect(()=>{c()},[]);const c=async()=>{try{const{data:s,error:x}=await b.from("shared_settings").select("setting_key, setting_value").in("setting_key",["pwa_app_name","pwa_short_name","pwa_description","app_id","app_internal_name","app_icon_url","app_favicon","app_logo","pwa_theme_color","pwa_background_color","app_web_url"]);if(x){console.error("Error loading app settings:",x),g();return}g();const d={...a};s?.forEach(l=>{switch(l.setting_key){case"pwa_app_name":d.appName=l.setting_value||"FastNow - Mindful App";break;case"pwa_short_name":d.shortName=l.setting_value||"FastNow";break;case"pwa_description":d.description=l.setting_value||"Your mindful app with AI-powered motivation";break;case"app_id":d.appId=l.setting_value||"app.lovable.de91d618edcf40eb8e117c45904095be";break;case"app_internal_name":d.internalName=l.setting_value||"fast-now-zenith";break;case"app_icon_url":d.appIcon=l.setting_value||"";break;case"app_favicon":d.favicon=l.setting_value||"";break;case"app_logo":d.logo=l.setting_value||"";break;case"pwa_theme_color":d.themeColor=l.setting_value||"#8B7355";break;case"pwa_background_color":d.backgroundColor=l.setting_value||"#F5F2EA";break;case"app_web_url":d.webUrl=l.setting_value||"https://de91d618-edcf-40eb-8e11-7c45904095be.lovableproject.com?forceHideBadge=true";break}}),i(d)}catch(s){console.error("Error loading app settings:",s),g()}finally{p(!1)}},g=()=>{i({appName:"FastNow - Mindful App",shortName:"FastNow",description:"Your mindful app with AI-powered motivation",appId:"app.lovable.de91d618edcf40eb8e117c45904095be",internalName:"fast-now-zenith",appIcon:"",favicon:"",logo:"",themeColor:"#8B7355",backgroundColor:"#F5F2EA",webUrl:"https://de91d618-edcf-40eb-8e11-7c45904095be.lovableproject.com?forceHideBadge=true"})},o=(s,x)=>{i(d=>({...d,[s]:x}))},B=async()=>{h(!0);try{const s=[{setting_key:"pwa_app_name",setting_value:a.appName},{setting_key:"pwa_short_name",setting_value:a.shortName},{setting_key:"pwa_description",setting_value:a.description},{setting_key:"app_id",setting_value:a.appId},{setting_key:"app_internal_name",setting_value:a.internalName},{setting_key:"app_icon_url",setting_value:a.appIcon},{setting_key:"app_favicon",setting_value:a.favicon},{setting_key:"app_logo",setting_value:a.logo},{setting_key:"pwa_theme_color",setting_value:a.themeColor},{setting_key:"pwa_background_color",setting_value:a.backgroundColor},{setting_key:"app_web_url",setting_value:a.webUrl}];for(const l of s){const{error:A}=await b.from("shared_settings").upsert(l,{onConflict:"setting_key"});if(A)throw console.error("Error saving app setting:",A),A}const{forcePWARefresh:x}=await Y(async()=>{const{forcePWARefresh:l}=await Promise.resolve().then(()=>se);return{forcePWARefresh:l}},void 0);await x()?console.log("PWA cache refreshed successfully"):console.warn("PWA cache refresh had issues, but settings were saved"),t({title:"‚úÖ Settings Saved!",description:"App identity settings updated successfully. PWA manifest refreshed - try 'Add to Home Screen' again!"})}catch(s){console.error("Error saving app settings:",s),t({title:"Error",description:`Failed to save settings: ${s.message}`,variant:"destructive"})}finally{h(!1)}},M=async()=>{try{const s=`import type { CapacitorConfig } from '@capacitor/cli';

const config: CapacitorConfig = {
  appId: '${a.appId}',
  appName: '${a.internalName}',
  webDir: 'dist',
  server: {
    url: '${a.webUrl}',
    cleartext: true
  },
  plugins: {
    SplashScreen: {
      launchShowDuration: 0
    },
    StatusBar: {
      style: 'default'
    }
  }
};

export default config;`;await b.from("shared_settings").upsert({setting_key:"capacitor_config_content",setting_value:s},{onConflict:"setting_key"}),t({title:"üöÄ Capacitor Config Generated!",description:"The capacitor.config.ts file content has been generated. Copy it to your local project after exporting to GitHub."})}catch(s){console.error("Error generating capacitor config:",s),t({title:"Error",description:"Failed to generate Capacitor config",variant:"destructive"})}};return r?e.jsxs(w,{children:[e.jsx(y,{children:e.jsxs(k,{className:"text-lg flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5"}),"App Identity & Branding"]})}),e.jsx(C,{className:"flex items-center justify-center py-8",children:e.jsx("span",{className:"text-muted-foreground",children:"Loading..."})})]}):e.jsxs(w,{children:[e.jsxs(y,{children:[e.jsxs(k,{className:"text-lg flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5"}),"App Identity & Branding"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure your app's name, icons, and branding across all platforms"})]}),e.jsxs(C,{children:[e.jsxs(U,{defaultValue:"identity",className:"w-full",children:[e.jsxs(L,{className:"grid w-full grid-cols-4",children:[e.jsxs(j,{value:"identity",className:"flex items-center gap-1",children:[e.jsx(P,{className:"w-4 h-4"}),"Identity"]}),e.jsxs(j,{value:"assets",className:"flex items-center gap-1",children:[e.jsx(V,{className:"w-4 h-4"}),"Assets"]}),e.jsxs(j,{value:"pwa",className:"flex items-center gap-1",children:[e.jsx(K,{className:"w-4 h-4"}),"PWA"]}),e.jsxs(j,{value:"native",className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-4 h-4"}),"Native"]})]}),e.jsxs(_,{value:"identity",className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"appName",children:"App Name (Full)"}),e.jsx(u,{id:"appName",value:a.appName,onChange:s=>o("appName",s.target.value),placeholder:"FastNow - Mindful App"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"The full name shown in app stores and browser tabs"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"shortName",children:"Short Name"}),e.jsx(u,{id:"shortName",value:a.shortName,onChange:s=>o("shortName",s.target.value),placeholder:"FastNow"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Short name for home screen icons (12 characters max)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"description",children:"Description"}),e.jsx(D,{id:"description",value:a.description,onChange:s=>o("description",s.target.value),placeholder:"Your mindful app with AI-powered motivation",rows:3}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"App description for app stores and PWA install prompts"})]})]}),e.jsx(_,{value:"assets",className:"space-y-6 mt-6",children:e.jsx("div",{className:"p-4 border border-border rounded-lg bg-muted/20",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["üîÑ ",e.jsx("strong",{children:"Note:"}),' Asset uploads have been moved to the dedicated "Brand Assets" section below to avoid conflicts. Use the Brand Assets Manager below for uploading your app icon, favicon, and logo.']})})}),e.jsxs(_,{value:"pwa",className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"themeColor",children:"Theme Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{id:"themeColor",value:a.themeColor,onChange:s=>o("themeColor",s.target.value),placeholder:"#8B7355"}),e.jsx("input",{type:"color",value:a.themeColor,onChange:s=>o("themeColor",s.target.value),className:"w-12 h-10 rounded border border-input"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Browser and status bar theme color"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"backgroundColor",children:"Background Color"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{id:"backgroundColor",value:a.backgroundColor,onChange:s=>o("backgroundColor",s.target.value),placeholder:"#F5F2EA"}),e.jsx("input",{type:"color",value:a.backgroundColor,onChange:s=>o("backgroundColor",s.target.value),className:"w-12 h-10 rounded border border-input"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Splash screen background color"})]})]}),e.jsxs(_,{value:"native",className:"space-y-4 mt-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"appId",children:"App ID (Bundle Identifier)"}),e.jsx(u,{id:"appId",value:a.appId,onChange:s=>o("appId",s.target.value),placeholder:"app.lovable.de91d618edcf40eb8e117c45904095be"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Unique identifier for app stores (reverse domain format)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"internalName",children:"Internal Name"}),e.jsx(u,{id:"internalName",value:a.internalName,onChange:s=>o("internalName",s.target.value),placeholder:"fast-now-zenith"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Internal project name (kebab-case, no spaces)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"webUrl",children:"Development URL"}),e.jsx(u,{id:"webUrl",value:a.webUrl,onChange:s=>o("webUrl",s.target.value),placeholder:"https://..."}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Live reload URL for development (from Lovable)"})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx(v,{onClick:M,variant:"outline",className:"w-full",children:"Generate Capacitor Config"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Generate capacitor.config.ts content for your local project"})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-6 mt-6 border-t",children:[e.jsx(v,{onClick:B,disabled:n,className:"flex-1",children:n?"Saving...":"Save All Settings"}),e.jsx(v,{onClick:c,variant:"outline",disabled:n,children:"Reset"})]})]})]})},ae=()=>{const{toast:a}=S(),i=async()=>{try{if("caches"in window){const r=await caches.keys();for(const p of r)await caches.delete(p)}if("serviceWorker"in navigator){const r=await navigator.serviceWorker.ready;r&&(await r.update(),r.active&&r.active.postMessage({type:"SKIP_WAITING"}))}setTimeout(()=>{location.reload()},1e3),a({title:"PWA Cache Refreshed",description:"Your app will reload with the latest assets. Changes to icons may take effect after reinstalling the app."})}catch(r){console.error("Error refreshing PWA cache:",r),a({title:"Error",description:"Failed to refresh PWA cache. Please try again.",variant:"destructive"})}};return e.jsxs(w,{children:[e.jsxs(y,{children:[e.jsxs(k,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(P,{className:"w-4 h-4"}),"PWA Management"]}),e.jsx(O,{children:"Update your app's home screen icon and manifest"})]}),e.jsxs(C,{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx("p",{className:"mb-2",children:"After updating your logo or app settings:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-xs",children:[e.jsx("li",{children:'Click "Refresh PWA Cache" below'}),e.jsx("li",{children:"Remove the app from your home screen (if already installed)"}),e.jsx("li",{children:"Add the app to home screen again to see the new icon"})]})]}),e.jsxs(v,{onClick:i,variant:"outline",className:"w-full",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Refresh PWA Cache"]})]})]})},F=async()=>{try{console.log("Starting PWA cache refresh (preserving uploaded icons)...");const{data:a}=await b.from("shared_settings").select("setting_key, setting_value").in("setting_key",["app_favicon","app_logo","app_icon_url"]),i={};a?.forEach(t=>{i[t.setting_key]=t.setting_value}),console.log("Preserving existing PWA settings:",i);const r=`?v=${Date.now()}&refresh=${Date.now()}`;if(i.app_favicon){const t=document.getElementById("dynamic-favicon"),c=document.getElementById("dynamic-shortcut-icon"),g=document.querySelectorAll('link[rel="icon"]');t&&(t.href=i.app_favicon+r,console.log("Updated dynamic favicon:",t.href)),c&&(c.href=i.app_favicon+r,console.log("Updated shortcut icon:",c.href)),g.forEach(o=>{o.href=i.app_favicon+r,console.log("Updated icon link:",o.href)})}const p=i.app_icon_url||i.app_logo;if(p&&document.querySelectorAll('link[rel="apple-touch-icon"]').forEach(c=>{c.href=p+r,console.log("Updated apple touch icon:",c.href)}),"caches"in window){const t=await caches.keys();console.log("Clearing ALL caches:",t),await Promise.all(t.map(c=>(console.log("Deleting cache:",c),caches.delete(c))))}if("serviceWorker"in navigator){const t=await navigator.serviceWorker.getRegistrations();for(const c of t)await c.unregister(),console.log("Unregistered service worker")}const n=document.querySelector('link[rel="manifest"]');if(n){const t=new URL(n.href,window.location.origin);t.searchParams.set("v",Date.now().toString()),t.searchParams.set("bust",Math.random().toString(36)),t.searchParams.set("refresh",Date.now().toString()),n.href=t.toString(),console.log("Manifest URL updated:",n.href)}return setTimeout(async()=>{try{const t=await navigator.serviceWorker.register("/sw.js");console.log("Re-registered service worker:",t)}catch(t){console.error("Failed to re-register service worker:",t)}},1e3),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(console.log("Mobile device detected, forcing page reload in 2 seconds..."),setTimeout(()=>{console.log("Reloading page for mobile cache clear..."),location.reload()},2e3)),console.log("PWA cache refresh completed (icons preserved)"),!0}catch(a){return console.error("Error refreshing PWA cache:",a),!1}},T=async()=>{try{const a=document.querySelector('link[rel="manifest"]');if(!a)return{isValid:!1,error:"No manifest link found"};console.log("Fetching manifest from:",a.href);const i=await fetch(a.href,{method:"GET",cache:"no-cache",headers:{"Cache-Control":"no-cache, no-store, must-revalidate"}});if(!i.ok)return{isValid:!1,error:`Failed to fetch manifest: ${i.status}`};const r=await i.json();console.log("Manifest data:",r);const n=["name","short_name","start_url","display"].filter(h=>!r[h]);return n.length>0?{isValid:!1,error:`Missing required fields: ${n.join(", ")}`,manifest:r}:{isValid:!0,manifest:r}}catch(a){return console.error("Manifest validation error:",a),{isValid:!1,error:`Error validating manifest: ${a.message}`}}},se=Object.freeze(Object.defineProperty({__proto__:null,forcePWARefresh:F,validatePWAManifest:T},Symbol.toStringTag,{value:"Module"})),te=()=>{const[a,i]=f.useState(!1),[r,p]=f.useState(!1),[n,h]=f.useState(null),{toast:t}=S(),c=async()=>{i(!0);try{const o=await T();h(o),o.isValid?t({title:"‚úÖ PWA Manifest Valid",description:`App name: ${o.manifest?.name||"N/A"}`}):t({title:"‚ö†Ô∏è PWA Manifest Issues",description:o.error,variant:"destructive"})}catch{t({title:"Error",description:"Failed to test PWA manifest",variant:"destructive"})}finally{i(!1)}},g=async()=>{p(!0);try{const o=await F();t(o?{title:"‚úÖ PWA Cache Refreshed",description:"Try 'Add to Home Screen' again - it should show updated info!"}:{title:"‚ö†Ô∏è Refresh Completed",description:"Cache refresh completed but some issues occurred. Check console for details.",variant:"destructive"})}catch{t({title:"Error",description:"Failed to refresh PWA cache",variant:"destructive"})}finally{p(!1)}};return e.jsxs(w,{children:[e.jsxs(y,{children:[e.jsxs(k,{className:"text-lg flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5"}),"PWA Testing & Validation"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Test and refresh your PWA manifest after making changes"})]}),e.jsxs(C,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(v,{onClick:c,disabled:a,variant:"outline",className:"flex items-center gap-2",children:[a?e.jsx(N,{className:"w-4 h-4 animate-spin"}):e.jsx(W,{className:"w-4 h-4"}),"Test Manifest"]}),e.jsxs(v,{onClick:g,disabled:r,className:"flex items-center gap-2",children:[r?e.jsx(N,{className:"w-4 h-4 animate-spin"}):e.jsx(N,{className:"w-4 h-4"}),"Force Refresh"]})]}),n&&e.jsxs("div",{className:"p-4 border border-border rounded-lg bg-muted/20",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.isValid?e.jsx(W,{className:"w-4 h-4 text-green-500"}):e.jsx(Q,{className:"w-4 h-4 text-red-500"}),e.jsxs("span",{className:"font-medium",children:["Manifest Status:",e.jsx($,{variant:n.isValid?"default":"destructive",className:"ml-2",children:n.isValid?"Valid":"Invalid"})]})]}),n.manifest&&e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",n.manifest.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Short Name:"})," ",n.manifest.short_name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Icons:"})," ",n.manifest.icons?.length||0," defined"]})]}),n.error&&e.jsx("p",{className:"text-sm text-red-600 mt-2",children:n.error})]}),e.jsxs("div",{className:"p-4 border border-border rounded-lg bg-blue-50 dark:bg-blue-950/20",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Testing Instructions:"}),e.jsxs("ol",{className:"text-sm space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:'After changing app settings, click "Force Refresh"'}),e.jsx("li",{children:"Wait 30 seconds for cache to clear"}),e.jsx("li",{children:'On mobile: Try "Add to Home Screen" in browser menu'}),e.jsx("li",{children:"Check if new app name and icon appear correctly"}),e.jsx("li",{children:"If issues persist, close and reopen browser completely"})]})]})]})]})};function ge(){return q({title:"Admin Branding ‚Äì Logos, Colors & SEO",description:"Manage brand assets, color themes, and SEO settings.",canonicalPath:"/admin/branding"}),e.jsxs("main",{className:"container mx-auto p-6 space-y-8 overflow-x-hidden bg-background min-h-[calc(100vh-80px)]",role:"main",children:[e.jsx("h1",{className:"sr-only",children:"Admin Branding"}),e.jsx(R,{}),e.jsx("section",{"aria-label":"App identity and branding settings",children:e.jsx(ee,{})}),e.jsx("section",{"aria-label":"Brand assets",children:e.jsx(G,{})}),e.jsx("section",{"aria-label":"PWA management",children:e.jsx(ae,{})}),e.jsx("section",{"aria-label":"PWA testing",children:e.jsx(te,{})}),e.jsx("section",{"aria-label":"Color management",children:e.jsx(H,{})}),e.jsxs("section",{"aria-label":"SEO settings",className:"pb-24",children:[e.jsx(z,{}),e.jsx("div",{className:"h-8"})]})]})}export{ge as default};
