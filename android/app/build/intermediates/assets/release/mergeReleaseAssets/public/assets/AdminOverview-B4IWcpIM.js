const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SimpleAnalyticsWidget-C8-9VhbZ.js","assets/ui-4JzjGctU.js","assets/vendor-D63tyEUO.js","assets/index-CNtalSg2.js","assets/supabase-CG8ZnHQM.js","assets/index-3dp0dgKp.css","assets/CancellationTracker-CRbSHPSN.js","assets/AdminTierStats-By7Nei8C.js","assets/OpenAIApiStats-D05bIwxe.js","assets/UserRequestLimits-DzWOs74V.js","assets/AdminSEOSettings-DbtG9d52.js","assets/globe-BkLxb4-L.js","assets/BrandAssetsManager-Ci-19AlT.js","assets/smartphone-C3ZD5vgF.js","assets/ColorManagement-CY4RVXOm.js","assets/PromptManagement-C5uY2jjB.js","assets/PaymentProviderSettings-DYPbOi4H.js","assets/AdminTimelineSettings-BB7LE_6b.js"])))=>i.map(i=>d[i]);
import{j as e}from"./ui-4JzjGctU.js";import{r as a}from"./vendor-D63tyEUO.js";import{L as K,s as h,J as I,C as f,a as y,b as j,c as v,d as A,e as M,f as b,S as O,T as q,I as T,B as S,u as G,g as U,h as W,i as B,j as J,k as Q,l as H}from"./index-CNtalSg2.js";import{_ as r}from"./supabase-CG8ZnHQM.js";import{A as Y}from"./AdminRoleTester-DsA0kw4G.js";import{A as Z}from"./AdminQuoteSettings-hH5AO4BH.js";const $=a.lazy(()=>r(()=>import("./SimpleAnalyticsWidget-C8-9VhbZ.js"),__vite__mapDeps([0,1,2,3,4,5])).then(s=>({default:s.SimpleAnalyticsWidget}))),ee=a.lazy(()=>r(()=>import("./CancellationTracker-CRbSHPSN.js"),__vite__mapDeps([6,1,2,3,4,5])).then(s=>({default:s.CancellationTracker}))),se=a.lazy(()=>r(()=>import("./AdminTierStats-By7Nei8C.js"),__vite__mapDeps([7,1,2,3,4,5])).then(s=>({default:s.AdminTierStats}))),te=a.lazy(()=>r(()=>import("./OpenAIApiStats-D05bIwxe.js"),__vite__mapDeps([8,1,2,3,4,5])).then(s=>({default:s.OpenAIApiStats}))),ae=a.lazy(()=>r(()=>import("./UserRequestLimits-DzWOs74V.js"),__vite__mapDeps([9,1,2,3,4,5])).then(s=>({default:s.UserRequestLimits}))),ie=a.lazy(()=>r(()=>import("./AdminSEOSettings-DbtG9d52.js"),__vite__mapDeps([10,1,2,3,4,5,11])).then(s=>({default:s.AdminSEOSettings}))),ne=a.lazy(()=>r(()=>import("./BrandAssetsManager-Ci-19AlT.js"),__vite__mapDeps([12,1,2,3,4,5,13]))),re=a.lazy(()=>r(()=>import("./ColorManagement-CY4RVXOm.js"),__vite__mapDeps([14,1,2,3,4,5])).then(s=>({default:s.ColorManagement}))),oe=a.lazy(()=>r(()=>import("./PromptManagement-C5uY2jjB.js"),__vite__mapDeps([15,1,2,3,4,5])).then(s=>({default:s.PromptManagement}))),le=a.lazy(()=>r(()=>import("./PaymentProviderSettings-DYPbOi4H.js"),__vite__mapDeps([16,1,2,3,4,5,13])).then(s=>({default:s.PaymentProviderSettings}))),ce=a.lazy(()=>r(()=>import("./AdminTimelineSettings-BB7LE_6b.js"),__vite__mapDeps([17,1,2,3,4,5])).then(s=>({default:s.AdminTimelineSettings}))),o=({children:s})=>e.jsx(a.Suspense,{fallback:e.jsx("div",{className:"flex items-center justify-center p-6",children:e.jsx(K,{})}),children:s}),de=()=>e.jsx(o,{children:e.jsx($,{})}),me=()=>e.jsx(o,{children:e.jsx(ee,{})}),he=()=>e.jsx(o,{children:e.jsx(se,{})}),ge=()=>e.jsx(o,{children:e.jsx(te,{})}),ue=()=>e.jsx(o,{children:e.jsx(ae,{})}),xe=()=>e.jsx(o,{children:e.jsx(ie,{})}),_e=()=>e.jsx(o,{children:e.jsx(ne,{})}),pe=()=>e.jsx(o,{children:e.jsx(re,{})}),fe=()=>e.jsx(o,{children:e.jsx(oe,{})}),ye=()=>e.jsx(o,{children:e.jsx(le,{})}),je=()=>e.jsx(o,{children:e.jsx(ce,{})});function ve(){const[s,d]=a.useState({strictMode:!0,redirectMessage:"I'm your food tracking assistant. I can help you log meals, analyze nutrition, and manage your food library. Let's keep our conversation focused on food and nutrition topics!",allowedTopics:"food,nutrition,meals,calories,carbs,diet,health,cooking,ingredients,recipes"}),[L,C]=a.useState(!0),[g,x]=a.useState(!1);a.useEffect(()=>{N()},[]);const N=async()=>{try{const{data:i,error:n}=await h.from("shared_settings").select("setting_key, setting_value").in("setting_key",["food_chat_strict_mode","food_chat_redirect_message","food_chat_allowed_topics"]);if(n)throw n;const c=i?.reduce((k,w)=>(k[w.setting_key]=w.setting_value,k),{})||{};d({strictMode:c.food_chat_strict_mode==="true",redirectMessage:c.food_chat_redirect_message||s.redirectMessage,allowedTopics:c.food_chat_allowed_topics||s.allowedTopics})}catch(i){console.error("Error loading chat settings:",i),I.error("Failed to load chat settings")}finally{C(!1)}},E=async()=>{x(!0);try{const i=[{setting_key:"food_chat_strict_mode",setting_value:s.strictMode.toString()},{setting_key:"food_chat_redirect_message",setting_value:s.redirectMessage},{setting_key:"food_chat_allowed_topics",setting_value:s.allowedTopics}];for(const n of i){const{error:c}=await h.from("shared_settings").upsert(n,{onConflict:"setting_key"});if(c)throw c}I.success("Chat settings updated successfully")}catch(i){console.error("Error saving chat settings:",i),I.error("Failed to save chat settings")}finally{x(!1)}};return L?e.jsxs(f,{children:[e.jsxs(y,{children:[e.jsx(j,{children:"Food Chat Settings"}),e.jsx(v,{children:"Configure AI chat behavior and guardrails"})]}),e.jsx(A,{className:"flex items-center justify-center py-8",children:e.jsx(M,{className:"h-6 w-6 animate-spin"})})]}):e.jsxs(f,{children:[e.jsxs(y,{children:[e.jsx(j,{children:"Food Chat Settings"}),e.jsx(v,{children:"Configure AI chat behavior and topic guardrails for the food tracking assistant"})]}),e.jsxs(A,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(b,{htmlFor:"strict-mode",children:"Strict Mode"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"When enabled, the AI will strictly enforce food-related topics and redirect off-topic conversations"})]}),e.jsx(O,{id:"strict-mode",checked:s.strictMode,onCheckedChange:i=>d(n=>({...n,strictMode:i}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"redirect-message",children:"Redirect Message"}),e.jsx(q,{id:"redirect-message",placeholder:"Message to show when users ask about off-topic subjects...",value:s.redirectMessage,onChange:i=>d(n=>({...n,redirectMessage:i.target.value})),rows:4}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"This message will be shown when users ask about non-food topics (only when strict mode is enabled)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"allowed-topics",children:"Allowed Topics"}),e.jsx(T,{id:"allowed-topics",placeholder:"food,nutrition,meals,calories...",value:s.allowedTopics,onChange:i=>d(n=>({...n,allowedTopics:i.target.value}))}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Comma-separated list of allowed conversation topics (used by AI to determine relevance)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(S,{onClick:E,disabled:g,className:"flex items-center gap-2",children:[g&&e.jsx(M,{className:"h-4 w-4 animate-spin"}),"Save"]}),e.jsx(S,{variant:"outline",onClick:N,disabled:g,children:"Reset"})]})]})]})}const Ne=()=>{const[s,d]=a.useState(!0),[L,C]=a.useState({total_users:0,active_users:0,paid_users:0,total_requests:0}),[g,x]=a.useState(""),[N,E]=a.useState(""),[i,n]=a.useState(""),[c,k]=a.useState(!1),[w,P]=a.useState(!1),{toast:m}=G();a.useEffect(()=>{R()},[]);const R=async()=>{try{d(!0);const{data:t,error:u}=await h.from("profiles").select("user_id, is_paid_user, monthly_ai_requests, created_at").order("created_at",{ascending:!1});u&&console.error("Error fetching users:",u);const{data:z,error:D}=await h.from("shared_settings").select("setting_key, setting_value").in("setting_key",["shared_api_key","stripe_api_key","ga_tracking_id","ai_image_analysis_enabled"]);if(D?console.error("Error fetching settings:",D):z&&z.forEach(l=>{l.setting_key==="shared_api_key"?x(l.setting_value||""):l.setting_key==="stripe_api_key"?E(l.setting_value||""):l.setting_key==="ga_tracking_id"?n(l.setting_value||""):l.setting_key==="ai_image_analysis_enabled"&&P(String(l.setting_value).toLowerCase()==="true")}),t){const l={total_users:t.length,active_users:t.filter(_=>{const p=new Date;return p.setDate(p.getDate()-7),new Date(_.created_at)>p}).length,paid_users:t.filter(_=>_.is_paid_user).length,total_requests:t.reduce((_,p)=>_+(p.monthly_ai_requests||0),0)};C(l)}}catch(t){console.error("Error fetching admin data:",t),m({title:"Error",description:"Failed to fetch admin data",variant:"destructive"})}finally{d(!1)}},F=async()=>{try{const{error:t}=await h.from("shared_settings").upsert({setting_key:"shared_api_key",setting_value:g});if(t)throw t;m({title:"Success",description:"API key saved successfully"})}catch(t){console.error("Error saving API key:",t),m({title:"Error",description:"Failed to save API key",variant:"destructive"})}},V=async()=>{try{const{error:t}=await h.from("shared_settings").upsert({setting_key:"ga_tracking_id",setting_value:i});if(t)throw t;m({title:"Success",description:"Google Analytics tracking ID saved successfully"})}catch(t){console.error("Error saving GA tracking ID:",t),m({title:"Error",description:"Failed to save Google Analytics tracking ID",variant:"destructive"})}},X=async t=>{try{const{error:u}=await h.from("shared_settings").upsert({setting_key:"ai_image_analysis_enabled",setting_value:t?"true":"false"});if(u)throw u;m({title:"Saved",description:"Image analysis testing flag updated."})}catch{m({title:"Error",description:"Failed to save setting",variant:"destructive"})}};return s?null:e.jsxs("main",{className:"container mx-auto p-6 space-y-8 overflow-x-hidden bg-background min-h-[calc(100vh-80px)]",role:"main",children:[e.jsx("div",{className:"flex items-center justify-center pt-6 pb-4",children:e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent text-center",children:"Admin Dashboard"})}),e.jsx("section",{"aria-label":"Role testing",children:e.jsx(Y,{})}),e.jsx("section",{"aria-label":"Real-time analytics",children:e.jsx(de,{})}),e.jsx("section",{"aria-label":"SEO settings",children:e.jsx(xe,{})}),e.jsx("section",{"aria-label":"Cancellation tracking",children:e.jsx(me,{})}),e.jsx("section",{"aria-label":"User tiers overview",children:e.jsx(he,{})}),e.jsx("section",{"aria-label":"User request limits",children:e.jsx(ue,{})}),e.jsxs("section",{className:"space-y-6","aria-labelledby":"api-config",children:[e.jsx("h2",{id:"api-config",className:"text-2xl font-semibold text-foreground",children:"API Configuration"}),e.jsxs(f,{children:[e.jsxs(y,{children:[e.jsxs(j,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),"OpenAI API Key"]}),e.jsx(v,{children:"Configure the shared OpenAI API key used for AI-powered features across the platform"})]}),e.jsxs(A,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"apiKey",className:"text-sm font-medium",children:"API Key"}),e.jsx(T,{id:"apiKey",type:"password",value:g,onChange:t=>x(t.target.value),placeholder:"sk-...",className:"font-mono text-sm"})]}),e.jsx(S,{onClick:F,variant:"action-secondary",size:"action-secondary",className:"w-full sm:w-auto",children:"Save"})]})]}),e.jsx(ge,{})]}),e.jsxs("section",{className:"space-y-6","aria-labelledby":"payment-analytics",children:[e.jsx("h2",{id:"payment-analytics",className:"text-2xl font-semibold text-foreground",children:"Payment & Analytics"}),e.jsx(ye,{}),e.jsxs(f,{children:[e.jsxs(y,{children:[e.jsx(j,{className:"text-xl font-semibold",children:"Google Analytics"}),e.jsx(v,{children:"Configure Google Analytics tracking ID for real-time analytics data"})]}),e.jsxs(A,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(b,{htmlFor:"gaTrackingId",className:"text-sm font-medium",children:"Measurement ID"}),e.jsx(T,{id:"gaTrackingId",type:"text",value:i,onChange:t=>n(t.target.value),placeholder:"G-XXXXXXXXXX",className:"font-mono text-sm"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(S,{onClick:V,variant:"action-secondary",size:"action-secondary",className:"flex-1 sm:flex-none",children:"Save"})})]})]})]}),e.jsx("section",{className:"space-y-6","aria-label":"Advanced settings",children:e.jsxs(U,{open:c,onOpenChange:k,children:[e.jsx(W,{asChild:!0,children:e.jsxs(S,{variant:"ghost",className:"w-full justify-between text-foreground hover:bg-muted",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4"}),"Advanced Settings"]}),c?e.jsx(J,{className:"w-4 h-4"}):e.jsx(Q,{className:"w-4 h-4"})]})}),e.jsxs(H,{className:"space-y-6 mt-6",children:[e.jsx(fe,{}),e.jsx(ve,{}),e.jsxs(f,{children:[e.jsxs(y,{children:[e.jsx(j,{className:"text-xl font-semibold",children:"Image Analysis (Admin Testing)"}),e.jsx(v,{children:"Enable the camera/upload button in AI Chat for admins only. Users will not see this."})]}),e.jsxs(A,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"text-sm font-medium",children:"Enable admin-only image analysis"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Toggles `ai_image_analysis_enabled` in shared settings"})]}),e.jsx(O,{checked:w,onCheckedChange:t=>{P(t),X(t)},"aria-label":"Toggle admin-only image analysis"})]})]})]})]})}),e.jsx("section",{"aria-label":"Quote management",children:e.jsx(Z,{})}),e.jsx("section",{"aria-label":"Timeline management",children:e.jsx(je,{})}),e.jsxs("section",{className:"space-y-6 pb-24","aria-labelledby":"brand-customization",children:[e.jsx("h2",{id:"brand-customization",className:"text-2xl font-semibold text-foreground",children:"Brand Customization"}),e.jsx(_e,{}),e.jsx(pe,{}),e.jsx("div",{className:"h-8"})]})]})};export{Ne as default};
