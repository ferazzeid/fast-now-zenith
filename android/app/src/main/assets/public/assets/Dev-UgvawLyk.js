import{j as e}from"./ui-4JzjGctU.js";import{A as Q}from"./AdminSubnav-Bw1kytFe.js";import{o as A,A as K,u as D,C as w,a as _,b as k,D as X,d as y,f as M,S as I,E as $,F as z,G as J,H as V,K as Z,M as L,B as p,R as O,N as ee,U as R,O as se,Q as G,s as b,V as S,W as te,X as C,z as E,Y as ne,Z as ae,_ as ie,n as re,$ as oe,a0 as le}from"./index-CNtalSg2.js";import{A as ce}from"./AdminRoleTester-DsA0kw4G.js";import{r as d}from"./vendor-D63tyEUO.js";import{G as de}from"./globe-BkLxb4-L.js";import"./supabase-CG8ZnHQM.js";/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],U=A("eye",me);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]],Y=A("heart",ue);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],F=A("wifi-off",fe);/**
 * @license lucide-react v0.526.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],W=A("wifi",he),xe=()=>{const{profile:i,updateProfile:n}=K(),{toast:x}=D(),[u,t]=d.useState(!0),[m,j]=d.useState(!0),[v,g]=d.useState(!0);d.useEffect(()=>{i&&(t(i.enable_fasting_slideshow??!0),j(i.enable_walking_slideshow??!0),g(i.enable_ceramic_animations??!0))},[i]);const N=async(l,f)=>{try{const c={[l]:f};await n(c),x({title:"Animation Settings Updated",description:"Your animation preferences have been saved."})}catch(c){console.error("Error updating animation settings:",c),x({title:"Error",description:"Failed to update animation settings. Please try again.",variant:"destructive"})}};return e.jsxs(w,{className:"bg-ceramic-plate border-ceramic-rim",children:[e.jsx(_,{children:e.jsxs(k,{className:"flex items-center gap-2 text-warm-text",children:[e.jsx(X,{className:"w-5 h-5"}),"Animation Controls"]})}),e.jsxs(y,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Y,{className:"w-4 h-4 text-primary"}),e.jsx(M,{htmlFor:"fasting-slideshow",className:"text-warm-text",children:"Fasting Motivator Slideshow"})]}),e.jsx(I,{id:"fasting-slideshow",checked:u,onCheckedChange:l=>{t(l),N("enable_fasting_slideshow",l)}})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Y,{className:"w-4 h-4 text-primary"}),e.jsx(M,{htmlFor:"walking-slideshow",className:"text-warm-text",children:"Walking Motivator Slideshow"})]}),e.jsx(I,{id:"walking-slideshow",checked:m,onCheckedChange:l=>{j(l),N("enable_walking_slideshow",l)}})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx($,{className:"w-4 h-4 text-primary"}),e.jsx(M,{htmlFor:"ceramic-animations",className:"text-warm-text",children:"Hourly Ceramic Timer Animations"})]}),e.jsx(I,{id:"ceramic-animations",checked:v,onCheckedChange:l=>{g(l),N("enable_ceramic_animations",l)}})]})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Control visual animations and effects throughout the app. Disabling animations can improve performance on slower devices."})]})]})},ge=J("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),q=d.forwardRef(({className:i,variant:n,...x},u)=>e.jsx("div",{ref:u,role:"alert",className:z(ge({variant:n}),i),...x}));q.displayName="Alert";const pe=d.forwardRef(({className:i,...n},x)=>e.jsx("h5",{ref:x,className:z("mb-1 font-medium leading-none tracking-tight",i),...n}));pe.displayName="AlertTitle";const P=d.forwardRef(({className:i,...n},x)=>e.jsx("div",{ref:x,className:z("text-sm [&_p]:leading-relaxed",i),...n}));P.displayName="AlertDescription";const H=({showFullScreen:i=!1,className:n,forceShow:x=!1})=>{const{isOnline:u,testConnection:t}=V(),{pending:m}=Z();return u&&!x?null:i?e.jsx("div",{className:"fixed inset-0 bg-background/95 backdrop-blur z-50 flex items-center justify-center p-4",children:e.jsxs(w,{className:"w-full max-w-md",children:[e.jsxs(_,{className:"text-center",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-muted rounded-full flex items-center justify-center mb-4",children:e.jsx(F,{className:"w-8 h-8 text-muted-foreground"})}),e.jsx(k,{children:"You're Offline"})]}),e.jsxs(y,{className:"space-y-4 text-center",children:[e.jsx("p",{className:"text-muted-foreground",children:"Check your internet connection to sync your latest changes."}),m>0&&e.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsxs("span",{children:[m," change(s) waiting to sync"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(p,{onClick:t,className:"w-full",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Check Connection"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Your timers and data are saved locally and will sync when you're back online."})]})]})]})}):e.jsx(w,{className:z("border-orange-200 bg-orange-50 dark:border-orange-900 dark:bg-orange-950",n),children:e.jsx(y,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(F,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-orange-800 dark:text-orange-200",children:"Limited connectivity"}),e.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400",children:"Some features may be unavailable"})]}),e.jsx(p,{size:"sm",variant:"outline",onClick:t,children:e.jsx(O,{className:"w-3 h-3"})})]})})})};class je extends d.Component{constructor(n){super(n),this.state={hasError:!1,isNetworkError:!1,errorInfo:""}}static getDerivedStateFromError(n){return{hasError:!0,isNetworkError:n.message.includes("fetch")||n.message.includes("network")||n.message.includes("offline")||n.name==="TypeError"&&n.message.includes("Failed to fetch"),errorInfo:n.message}}componentDidCatch(n,x){console.error("Network Error Boundary caught an error:",n,x)}handleRetry=()=>{this.setState({hasError:!1,isNetworkError:!1,errorInfo:""})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"flex items-center justify-center min-h-[200px] p-4",children:e.jsxs(w,{className:"w-full max-w-md",children:[e.jsxs(_,{className:"text-center",children:[e.jsx("div",{className:"mx-auto w-12 h-12 bg-destructive/10 rounded-full flex items-center justify-center mb-3",children:this.state.isNetworkError?e.jsx(W,{className:"w-6 h-6 text-destructive"}):e.jsx(ee,{className:"w-6 h-6 text-destructive"})}),e.jsx(k,{className:"text-lg",children:this.state.isNetworkError?"Connection Problem":"Something went wrong"})]}),e.jsxs(y,{className:"space-y-4 text-center",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:this.state.isNetworkError?"Unable to connect to our servers. Please check your internet connection.":"An unexpected error occurred. Please try again."}),e.jsxs(p,{onClick:this.handleRetry,className:"w-full",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Try Again"]}),this.state.isNetworkError&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Your data is saved locally and will sync when you're back online."})]})]})}):this.props.children}}const we=({shouldError:i})=>{if(i)throw new Error("Network request failed: Failed to fetch");return e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("p",{className:"text-sm text-green-600",children:"âœ“ Component loaded successfully"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Click below to simulate a network error"})]})},Ne=()=>{const[i,n]=d.useState(!1),x=()=>{n(!0)},u=()=>{n(!1)};return e.jsxs("div",{className:"space-y-3",children:[e.jsxs(je,{children:[e.jsx(we,{shouldError:i}),!i&&e.jsx(p,{onClick:x,variant:"outline",size:"sm",children:"Trigger Network Error"})]}),i&&e.jsx(p,{onClick:u,variant:"outline",size:"sm",className:"mt-2",children:"Reset Test"})]})},ve=({children:i})=>e.jsxs("div",{className:"space-y-4 max-h-full overflow-auto",children:[e.jsx(w,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx($,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Fasting Timer"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"14:32:15 elapsed"})]})]})}),i,e.jsx(w,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(R,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Today's Meals"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"1,245 calories logged"})]})]}),e.jsx(p,{size:"sm",variant:"outline",children:"Add Food"})]})}),e.jsx(w,{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(se,{className:"w-5 h-5 text-primary"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:"Walking Stats"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"8,432 steps today"})]})]})})]}),ye=()=>{const[i,n]=d.useState(null),[x,u]=d.useState(!1),{user:t}=G(),{toast:m}=D(),j=d.useCallback(async()=>{if(!t){n(null),u(!1);return}u(!0);try{const{data:l,error:f}=await b.from("fasting_sessions").select("*").eq("user_id",t.id).eq("status","active").order("start_time",{ascending:!1}).limit(1).maybeSingle();f&&navigator.onLine&&console.error("Error loading fasting session:",f);const c=l||null;n(c),c&&S({id:c.id,start_time:c.start_time,goal_duration_seconds:c.goal_duration_seconds,status:c.status,user_id:c.user_id})}catch(l){console.error("Error loading active session:",l);const f=te();f&&f.user_id===t.id&&f.status==="active"?n(f):n(null)}finally{u(!1)}},[t]);d.useEffect(()=>{t?j():(n(null),u(!1))},[t,j]);const v=d.useCallback(async(l,f)=>{if(!t)return m({title:"Error",description:"You must be logged in to start a fasting session",variant:"destructive"}),null;u(!0);const c=f?f.toISOString():new Date().toISOString(),s=`local-${Date.now()}`,r={id:s,user_id:t.id,start_time:c,goal_duration_seconds:l,status:"active",created_at:new Date().toISOString(),updated_at:new Date().toISOString()};try{if(navigator.onLine){await b.from("fasting_sessions").update({status:"cancelled",end_time:new Date().toISOString()}).eq("user_id",t.id).eq("status","active");const{data:h,error:o}=await b.from("fasting_sessions").insert([{user_id:t.id,start_time:c,goal_duration_seconds:l,status:"active"}]).select().single();if(o)throw o;const a=h;return n(a),S({id:a.id,start_time:a.start_time,goal_duration_seconds:a.goal_duration_seconds,status:a.status,user_id:a.user_id}),a}else throw new Error("Offline mode")}catch{return console.log("Going offline for fasting session start"),await C({entity:"fasting_session",action:"start",user_id:t.id,payload:{local_id:s,start_time:c,goal_duration_seconds:l}}),n(r),S({id:s,start_time:c,goal_duration_seconds:l,status:"active",user_id:t.id}),m({title:"ðŸŽ¯ Fasting Started (Offline)",description:"Your session will sync when back online."}),r}finally{u(!1)}},[t,m]),g=d.useCallback(async l=>{if(!t||!i)return null;const f=l||i.id;u(!0);try{const c=new Date().toISOString(),s=i.start_time,r=Math.floor((new Date(c).getTime()-new Date(s).getTime())/1e3),h="completed";if(navigator.onLine&&!f.startsWith("local-")){const{data:o,error:a}=await b.from("fasting_sessions").update({status:h,end_time:c,duration_seconds:r}).eq("id",f).eq("user_id",t.id).select().single();if(a)throw a;return n(null),S(null),o}else throw new Error("Offline mode or local session")}catch{return console.log("Going offline for fasting session end"),await C({entity:"fasting_session",action:"end",user_id:t.id,payload:{session_id:f,end_time:new Date().toISOString(),duration_seconds:Math.floor((new Date().getTime()-new Date(i.start_time).getTime())/1e3),status:"completed"}}),n(null),S(null),m({title:"ðŸŽ‰ Fasting Completed (Offline)",description:"Your session will sync when back online."}),null}finally{u(!1)}},[t,i,m]),N=d.useCallback(async l=>{if(!t||!i)return null;const f=l||i.id;u(!0);try{if(navigator.onLine&&!f.startsWith("local-")){const{data:c,error:s}=await b.from("fasting_sessions").update({status:"cancelled",end_time:new Date().toISOString()}).eq("id",f).eq("user_id",t.id).select().single();if(s)throw s;return n(null),S(null),c}else throw new Error("Offline mode or local session")}catch{return console.log("Going offline for fasting session cancel"),await C({entity:"fasting_session",action:"cancel",user_id:t.id,payload:{session_id:f}}),n(null),S(null),m({title:"Fasting Cancelled (Offline)",description:"Your cancellation will sync when back online."}),null}finally{u(!1)}},[t,i,m]);return{currentSession:i,loading:x,startFastingSession:v,endFastingSession:g,cancelFastingSession:N,loadActiveSession:j}},be=()=>{const[i,n]=d.useState([]),[x,u]=d.useState(!1),{user:t}=G(),{toast:m}=D(),j={calories:i.filter(s=>s.consumed).reduce((s,r)=>s+r.calories,0),carbs:i.filter(s=>s.consumed).reduce((s,r)=>s+r.carbs,0)},v=d.useCallback(async()=>{if(!t){n([]),u(!1);return}u(!0);try{const s=new Date;s.setHours(0,0,0,0);const r=new Date(s);r.setDate(r.getDate()+1);const{data:h,error:o}=await b.from("food_entries").select("*").eq("user_id",t.id).gte("created_at",s.toISOString()).lt("created_at",r.toISOString()).order("consumed",{ascending:!0}).order("created_at",{ascending:!1});if(o&&navigator.onLine){console.error("Error loading food entries:",o);return}n(h||[])}catch(s){console.error("Error loading food entries:",s)}finally{u(!1)}},[t]);d.useEffect(()=>{t?v():(n([]),u(!1))},[t,v]);const g=d.useCallback(async s=>{if(!t)throw new Error("User not authenticated");const r=`local-${Date.now()}`,h={id:r,user_id:t.id,name:s.name,calories:s.calories,carbs:s.carbs,serving_size:s.serving_size,consumed:s.consumed??!0,image_url:s.image_url,created_at:new Date().toISOString()};n(o=>[h,...o]);try{if(navigator.onLine){const{data:o,error:a}=await b.from("food_entries").insert({user_id:t.id,name:s.name,calories:s.calories,carbs:s.carbs,serving_size:s.serving_size,consumed:s.consumed??!0,image_url:s.image_url}).select().single();if(a)throw a;return n(T=>T.map(B=>B.id===r?o:B)),o}else throw new Error("Offline mode")}catch{return console.log("Going offline for food entry creation"),await C({entity:"food_entry",action:"create",user_id:t.id,payload:{local_id:r,name:s.name,calories:s.calories,carbs:s.carbs,serving_size:s.serving_size,consumed:s.consumed??!0,image_url:s.image_url}}),m({title:"Food Added (Offline)",description:"Entry will sync when back online."}),h}},[t,m]),N=d.useCallback(async({id:s,updates:r})=>{if(!t)throw new Error("User not authenticated");n(h=>h.map(o=>o.id===s?{...o,...r}:o));try{if(navigator.onLine&&!s.startsWith("local-")){const{data:h,error:o}=await b.from("food_entries").update(r).eq("id",s).eq("user_id",t.id).select().single();if(o)throw o;return n(a=>a.map(T=>T.id===s?h:T)),h}else throw new Error("Offline mode or local entry")}catch{console.log("Going offline for food entry update"),await C({entity:"food_entry",action:"update",user_id:t.id,payload:{entry_id:s,updates:r}}),m({title:"Food Updated (Offline)",description:"Changes will sync when back online."})}},[t,m]),l=d.useCallback(async s=>{if(!t)throw new Error("User not authenticated");n(r=>r.filter(h=>h.id!==s));try{if(navigator.onLine&&!s.startsWith("local-")){const{error:r}=await b.from("food_entries").delete().eq("id",s).eq("user_id",t.id);if(r)throw r}else throw new Error("Offline mode or local entry")}catch{console.log("Going offline for food entry deletion"),s.startsWith("local-")||await C({entity:"food_entry",action:"delete",user_id:t.id,payload:{entry_id:s}}),m({title:"Food Deleted (Offline)",description:"Deletion will sync when back online."})}},[t,m,i]),f=d.useCallback(async s=>{if(!t)throw new Error("User not authenticated");const r=i.find(o=>o.id===s);if(!r)throw new Error("Entry not found");const h=!r.consumed;n(o=>o.map(a=>a.id===s?{...a,consumed:h}:a));try{if(navigator.onLine&&!s.startsWith("local-")){const{data:o,error:a}=await b.from("food_entries").update({consumed:h}).eq("id",s).eq("user_id",t.id).select().single();if(a)throw a;const T=o.consumed?"Food marked as eaten":"Food returned to active list";return m({title:T,description:"Food status updated successfully."}),o}else throw new Error("Offline mode or local entry")}catch{console.log("Going offline for consumption toggle"),await C({entity:"food_entry",action:"toggle_consumed",user_id:t.id,payload:{entry_id:s,consumed:h}}),m({title:h?"Food marked as eaten (Offline)":"Food returned to active list (Offline)",description:"Status will sync when back online."})}},[t,m,i]),c=d.useCallback(async()=>{await v()},[v]);return{todayEntries:i,todayTotals:j,loading:x,addFoodEntry:g,updateFoodEntry:N,deleteFoodEntry:l,toggleConsumption:f,refreshFoodEntries:c,isAddingEntry:!1,isUpdatingEntry:!1,isDeletingEntry:!1,isTogglingConsumption:!1}},_e=()=>{G();const{isSyncing:i,pending:n,triggerSync:x}=Z(),{startFastingSession:u,endFastingSession:t,currentSession:m}=ye(),{addFoodEntry:j,todayEntries:v}=be(),[g,N]=d.useState([]),[l,f]=d.useState(navigator.onLine);d.useState(()=>{const a=()=>f(navigator.onLine);return window.addEventListener("online",a),window.addEventListener("offline",a),()=>{window.removeEventListener("online",a),window.removeEventListener("offline",a)}});const c=async()=>{const a=await ne();N(a)},s=async()=>{try{m?await t():await u(3600),await c()}catch(a){console.error("Fasting test error:",a)}},r=async()=>{try{await j({name:`Test Food ${Date.now()}`,calories:100,carbs:20,serving_size:100,consumed:!0}),await c()}catch(a){console.error("Food test error:",a)}},h=a=>{switch(a){case"walking_session":return e.jsx($,{className:"w-4 h-4"});case"fasting_session":return e.jsx(L,{className:"w-4 h-4"});case"food_entry":return e.jsx(R,{className:"w-4 h-4"});default:return e.jsx(ae,{className:"w-4 h-4"})}},o=a=>{switch(a){case"start":return"bg-green-500";case"end":case"cancel":return"bg-red-500";case"create":return"bg-blue-500";case"update":case"toggle_consumed":return"bg-yellow-500";case"delete":return"bg-red-600";default:return"bg-gray-500"}};return e.jsxs(w,{className:"w-full",children:[e.jsx(_,{children:e.jsxs(k,{className:"flex items-center gap-2",children:[l?e.jsx(W,{className:"w-5 h-5 text-green-500"}):e.jsx(F,{className:"w-5 h-5 text-red-500"}),"Offline Testing Panel",e.jsx(E,{variant:"outline",children:l?"Online":"Offline"})]})}),e.jsxs(y,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(E,{variant:n>0?"destructive":"secondary",children:[n," pending operations"]}),i&&e.jsx(E,{variant:"outline",children:"Syncing..."})]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx(p,{size:"sm",variant:"outline",onClick:c,children:"Refresh Queue"}),e.jsx(p,{size:"sm",onClick:x,disabled:i,children:"Sync Now"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(w,{children:[e.jsx(_,{className:"pb-3",children:e.jsxs(k,{className:"text-lg flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5"}),"Fasting Session Test"]})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Current: ",m?"Active Session":"No Session"]}),e.jsx(p,{size:"sm",onClick:s,className:"w-full",children:m?"End Session":"Start Session"})]})})]}),e.jsxs(w,{children:[e.jsx(_,{className:"pb-3",children:e.jsxs(k,{className:"text-lg flex items-center gap-2",children:[e.jsx(R,{className:"w-5 h-5"}),"Food Entry Test"]})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Today: ",v.length," entries"]}),e.jsx(p,{size:"sm",onClick:r,className:"w-full",children:"Add Test Food"})]})})]})]}),g.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Pending Operations"}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:g.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[h(a.entity),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:a.entity}),e.jsx(E,{variant:"secondary",className:`text-white ${o(a.action)}`,children:a.action})]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Created: ",new Date(a.createdAt).toLocaleTimeString()]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm",children:["Attempts: ",a.attempts||0]}),a.lastError&&e.jsx("p",{className:"text-xs text-red-500 max-w-40 truncate",children:a.lastError})]})]},a.id))})]}),e.jsx(w,{className:"bg-muted",children:e.jsxs(y,{className:"pt-6",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Testing Instructions:"}),e.jsxs("ol",{className:"text-sm space-y-1 list-decimal list-inside text-muted-foreground",children:[e.jsx("li",{children:"Go offline (disable internet) to test offline functionality"}),e.jsx("li",{children:"Use test buttons to create operations while offline"}),e.jsx("li",{children:'Check "Pending Operations" to see queued items'}),e.jsx("li",{children:'Go back online and click "Sync Now" to process queue'}),e.jsx("li",{children:"Verify operations appear in database after sync"})]})]})})]})]})};function Ae(){const{isOnline:i,lastChecked:n,isTestingConnection:x,testConnection:u}=V(),{toast:t}=D(),m=ie(),[j,v]=d.useState(!1),[g,N]=d.useState(null),[l,f]=d.useState("normal");re({title:"Admin Dev",description:"Developer tools and role testing.",canonicalPath:"/admin/dev"});const c=async()=>{await u()},s=()=>{window.location.reload()},r=()=>{f("slow"),t({title:"Slow Network Simulation",description:"Network requests will be delayed to simulate poor connectivity"}),setTimeout(()=>{f("normal"),t({title:"Network Restored",description:"Network simulation returned to normal"})},1e4)},h=()=>{t({title:"Recovery Test Started",description:"Simulating offline â†’ online recovery flow"}),setTimeout(()=>{t({title:"Recovery Complete",description:"All pending data has been synced successfully"})},3e3)},o=()=>{t({title:"Blocking Action Simulated",description:"This action would be blocked when offline",variant:"destructive"})};return e.jsx(oe,{children:e.jsxs("main",{className:`container mx-auto ${m?"p-4":"p-6"} space-y-6 overflow-x-hidden bg-background min-h-[calc(100vh-80px)]`,role:"main",children:[e.jsx("h1",{className:"sr-only",children:"Admin Dev"}),e.jsx(Q,{}),e.jsxs("section",{"aria-label":"Role Testing",className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Role Testing"}),e.jsxs(q,{children:[e.jsx(le,{className:"h-4 w-4"}),e.jsx(P,{children:"Test how the app behaves for different user roles. Admin dashboard access remains available regardless of test role."})]}),e.jsx(ce,{})]}),e.jsxs("section",{"aria-label":"Animation Settings",className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Animation Settings"}),e.jsx(xe,{})]}),e.jsxs("section",{"aria-label":"Connection Debug",className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Connection Debug"}),e.jsx(w,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(W,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"text-lg font-semibold",children:"Network Status"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${i?"bg-green-500":"bg-red-500"}`}),e.jsxs("span",{className:"text-sm",children:["Status: ",i?"Online":"Offline"]})]})}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Last checked: ",new Date(n).toLocaleTimeString()]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Navigator online: ",typeof navigator<"u"?navigator.onLine.toString():"undefined"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(p,{onClick:c,variant:"outline",size:"sm",disabled:x,className:"flex items-center gap-2",children:[e.jsx(O,{className:`w-4 h-4 ${x?"animate-spin":""}`}),x?"Testing...":"Test Connection"]}),e.jsx(p,{onClick:s,variant:"outline",size:"sm",children:"Reload App"})]})]})]})})]}),e.jsxs("section",{"aria-label":"Offline Testing",className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Offline Testing"}),e.jsxs(q,{children:[e.jsx(de,{className:"h-4 w-4"}),e.jsx(P,{children:"Test offline screens and user experience without actually going offline. Preview how the app handles network issues."})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs(w,{children:[e.jsx(_,{children:e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"w-5 h-5"}),"Offline Simulation"]})}),e.jsxs(y,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"Test Mode"}),e.jsx("div",{className:`w-2 h-2 rounded-full ${j?"bg-orange-500":"bg-green-500"}`})]}),e.jsx(p,{onClick:()=>v(!j),variant:j?"destructive":"outline",className:"w-full",children:j?"Stop Offline Test":"Start Offline Test"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"Preview Modes"}),e.jsxs("div",{className:`grid ${m?"grid-cols-1":"grid-cols-2"} gap-2`,children:[e.jsx(p,{onClick:()=>N(g==="banner"?null:"banner"),variant:g==="banner"?"default":"outline",size:"sm",children:"Banner"}),e.jsx(p,{onClick:()=>N(g==="fullscreen"?null:"fullscreen"),variant:g==="fullscreen"?"default":"outline",size:"sm",children:"Full Screen"}),e.jsx(p,{onClick:()=>N(g==="error"?null:"error"),variant:g==="error"?"default":"outline",size:"sm",children:"Error Boundary"}),e.jsx(p,{onClick:()=>N(null),variant:"ghost",size:"sm",children:"Clear"})]})]}),e.jsxs("div",{className:"pt-2 text-xs text-muted-foreground",children:[e.jsx("p",{children:"â€¢ Banner: Shows inline offline notification"}),e.jsx("p",{children:"â€¢ Full Screen: Shows blocking offline screen"}),e.jsx("p",{children:"â€¢ Error Boundary: Shows network error recovery"})]})]})]}),e.jsxs(w,{children:[e.jsx(_,{children:e.jsxs(k,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5"}),"Preview Area"]})}),e.jsx(y,{children:e.jsxs("div",{className:"border rounded-lg p-4 min-h-[300px] bg-muted/30 relative overflow-hidden",children:[g==="banner"&&e.jsx(ve,{children:e.jsx(H,{forceShow:!0,className:"w-full"})}),g==="fullscreen"&&e.jsx("div",{className:"absolute inset-0 rounded-lg overflow-hidden",children:e.jsx(H,{forceShow:!0,showFullScreen:!0})}),g==="error"&&e.jsx(Ne,{}),!g&&e.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:e.jsxs("div",{className:"text-center",children:[e.jsx(U,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Select a preview mode to see offline screens"})]})})]})})]})]}),e.jsxs(w,{children:[e.jsx(_,{children:e.jsx(k,{children:"Test Scenarios"})}),e.jsx(y,{children:e.jsxs("div",{className:`grid grid-cols-1 ${m?"":"lg:grid-cols-2"} gap-4`,children:[e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Gradual Degradation"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Test how the app behaves when going from online to offline"}),e.jsx(p,{variant:"outline",size:"sm",className:"w-full",onClick:r,disabled:l==="slow",children:l==="slow"?"Simulating...":"Simulate Slow Network"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Recovery Flow"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Test reconnection and data sync after being offline"}),e.jsx(p,{variant:"outline",size:"sm",className:"w-full",onClick:h,children:"Test Recovery"})]}),e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Critical Actions"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Test blocking offline actions that require connectivity"}),e.jsx(p,{variant:"outline",size:"sm",className:"w-full",onClick:o,children:"Test Blocking"})]})]})})]})]}),e.jsx("section",{children:e.jsx(_e,{})})]})})}export{Ae as default};
